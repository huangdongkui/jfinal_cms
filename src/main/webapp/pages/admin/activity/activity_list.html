<%
var headContent = {
include("/pages/template/head.html"){}
%>

<script type="text/javascript">

    var oper;
    jQuery(function ($) {
        // 页面方法
        oper = {
            width: 400,
            height: 500,
            form: document.form1,
            list: function () {
                var url = 'admin/activity/list';
                this.form.action = url;
                this.form.submit();
            },
            view: function (id) {
                var url = 'admin/advicefeedback/view/' + id;
                var title = '查看意见反馈';
                Iframe(url, this.width, this.height, title, false, false, false, EmptyFunc);
            },
            add: function () {
                var url = 'admin/activity/add';
                var title = '添加意见反馈';
                Iframe(url, this.width, this.height, title);
            },
            edit: function (id) {
                var url = 'admin/activity/edit/' + id;
                var title = '修改意见反馈';
                Iframe(url, this.width, this.height, title);
            },
            del: function (id) {
                var url = 'admin/activity/delete/' + id;
                var title = '确认要删除该意见反馈信息？';
                Confirm(title, function () {
                    form1.action = url;
                    form1.submit();
                });
            }
        };
        //显示Menu索引
        //showMenu('page_advicefeedback');
        selectActivity();
    });

    //分页
    var paginator = function (page) {
        oper.list();
    };
    
    function selectActivity(id) {



    $('#tb_slave').bootstrapTable({
        url: 'activity/busiActivitySlaveBy',         //请求后台的URL（*）
        method: 'get',                      //请求方式（*）
        //toolbar: '#toolbar',                //工具按钮用哪个容器
        striped: true,                      //是否显示行间隔色
        cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
        pagination: false,                   //是否显示分页（*）
        sortable: false,                     //是否启用排序
        sortOrder: "asc",                   //排序方式
        queryParams: function (params) {
            var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
                limit: params.limit,   //页面大小
                offset: params.offset,  //页码
                busi_activity_id: id
            };
            return temp;
        }
    ,//传递参数（*）
        sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
        pageNumber:1,                       //初始化加载第一页，默认第一页
        pageSize: 10,                       //每页的记录行数（*）
        pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
        search: false,                       //是否显示表格搜索，此搜索是客户端搜索，不会进服务端，所以，个人感觉意义不大
        strictSearch: false,
        showColumns: true,                  //是否显示所有的列
        showRefresh: false,                  //是否显示刷新按钮
        minimumCountColumns: 2,             //最少允许的列数
        clickToSelect: true,                //是否启用点击选中行
       height: 500,                        //行高，如果没有设置height属性，表格自动根据记录条数觉得表格高度
        uniqueId: "id",                     //每一行的唯一标识，一般为主键列
        showToggle:true,                    //是否显示详细视图和列表视图的切换按钮
        cardView: false,                    //是否显示详细视图
        detailView: false,                   //是否显示父子表
        columns: [{
            field: 'id',
            title: '序号'
        },{
            field: 'nodeid',
            title: '活动节点'
        }, {
            field: 'from_time',
            title: '开始日期'
        }, {
            field: 'to_time',
            title: '结束日期'
        }, {
            field: 'JudgesUid',
            title: '专家列表'
        }, {
            field: 'operation',
            title: '操作'

        }]
    });

    var queryParams = function (params) {
        var temp = {   //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
            limit: params.limit,   //页面大小
            offset: params.offset,  //页码
            busi_activity_id: id
        };
        return temp;
    };
    }
</script>

<%
};

var bodyContent = {
%>
<form name="form1" action="" method="post" class="form-inline" role="form">
    <input type="hidden" name="form.orderColumn" value="${form.orderColumn!''}"/>
    <input type="hidden" name="form.orderAsc" value="${form.orderAsc!''}"/>
    <!-- 菜单 -->
    <% include("/pages/template/menu.html"){} %>

    <div class="tableSearch">
        <% //查询列表 %>
        <div class="form-group">
            <input class="form-control" type="text" name="attr.username" value="${attr.username!''}"
                   placeholder="请输入用户名" required='required'/>
        </div>
        <div class="form-group">
            <input class="form-control" type="text" name="attr.qq" value="${attr.qq!''}"
                   placeholder="请输入qq" required='required'/>
        </div>
        <div class="form-group">
            <input class="form-control" type="text" name="attr.email" value="${attr.email!''}"
                   placeholder="请输入邮箱" required='required'/>
        </div>
        <div class="form-group">
            <input class="form-control" type="text" name="attr.telphone" value="${attr.telphone!''}"
                   placeholder="请输入手机号" required='required'/>
        </div>

        <button type="button" class="btn btn-default" onclick="oper.list();" name="search">
            <span class="glyphicon glyphicon-search"></span> 查 询
        </button>
        <button type="button" class="btn btn-default" onclick="resetForm();">
            <span class="glyphicon glyphicon-refresh"></span> 重 置
        </button>
        <button type="button" class="btn btn-default" onclick="oper.add();">
            <span class="glyphicon glyphicon-plus"></span> 新 增
        </button>
    </div>
    <div>
    <!-- 数据列表 -->
    <table class="table table-striped table-bordered table-hover">
        <thead>
        <tr>
            <th>序号</th>
            <% // 列表头部 %>
            <th name="activity_name" class="sorting">活动名称</th>
            <th name="activity_status" class="sorting">状态</th>
            <th name="scoretpl_id" class="sorting">评分模板</th>
            <th class="sorting">发布</th>
            <th name="create_time" class="sorting">创建时间</th>
            <th>备注</th>
            <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <% for(item in page.list){ %>
        <tr onclick="selectActivity(${item.id})">
            <td>${itemLP.index }</td>
            <% // 列表内容 %>
            <td>${item.activity_name}</td>
            <td>${item.activity_status}</td>
            <td>${item.scoretpl_id}</td>
            <td><a href="javascript:void(0);" class="btn btn-sm btn-success" onclick="oper.view(${item.id});">发布</a>
            </td>
            <td>${item.create_time}</td>
            <td></td>
            <td>

                <a href="javascript:void(0);" class="btn btn-sm btn-primary" onclick="oper.edit(${item.id});">修改</a>
                <a href="javascript:void(0);" class="btn btn-sm btn-danger" onclick="oper.del(${item.id});">删除</a>
            </td>
        </tr>
        <% } %>
        </tbody>
    </table>

    <%include("/pages/includes/paginator.html"){} %>
</div>

    <div class="panel panel-success">
        <div class="panel-heading">
            <h3 class="panel-title">赛事详情</h3>
        </div>
        <div class="panel-body">

            <table id="tb_slave" class="table table-striped table-bordered table-hover"></table>
        </div>
    </div>

</form>
<%}; %>


<% layout("/pages/template/_layout.html",{head:headContent,body:bodyContent}){ %>
<%} %>